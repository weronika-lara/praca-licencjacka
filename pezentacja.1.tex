\documentclass[notheorems]{beamer}
\usepackage[utf8]{inputenc}
\usepackage{Sweave}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{polski}
\usepackage{amsmath}
\usepackage{centernot}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumerate}
\usepackage{natbib} %bibtex
\usepackage[polish]{dyschemist}
\newtheorem{tw}{Twierdzenie}
%\usepackage{dyschemist}
\author{Weronika Lara, 204107}
\title{Numeryczne rozwiązywanie równań różniczkowych drugiego rzędu z warunkami brzegowymi}
\date{19.09.2019}
\institute{Praca licencjacka przygotowana pod opieką dr, mgr inż. Piotra Kowalskiego}
\newcommand{\parauporzadkowana}[2]{\left\langle {#1}; {#2} \right\rangle}
\newcommand{\zbior}[1]{\left\lbrace {#1} \right\rbrace }
\newcommand{\domkniecie}[1]{\left[ {#1} \right] }
\newcommand{\notiff}{%
  \mathrel{{\ooalign{\hidewidth$\not\phantom{"}$\hidewidth\cr$\iff$}}}}
%\newcommand{\tuple}[1]{\left\langle {#1} \right\rangle}


\begin{document}
\begin{frame}
\titlepage
\end{frame}

\begin{frame}
W teorii numerycznych równań różniczkowych spotyka się dwa rodzaje dyskretyzacji:
\begin{itemize}
\item dyskretyzacja w dziedzinie,
\item dyskretyzacja w przestrzeni funkcyjnej.
\end{itemize}
\end{frame}
\begin{frame}
\begin{small}
\begin{definition}[Operator różnicowy wprzód ]\label{operator_wporzd}
Dla ustalonego kroku $h>0 $, operatorem różnicowym wprzód nazywać będziemy 
$$
\delta_h u(x) = \frac{u(x+h) - u(x)}{h}
$$
\end{definition}
\begin{definition}[Operator różnicowy w tył]\label{operator_wtyl}
Dla ustalonego kroku $h>0$. Operatorem różnicowym w tył nazywać będziemy 
$$
\overline{\delta_h} u(x) = \frac{u(x)-u(x-h)}{h} 
$$
\end{definition}

\begin{definition}[Operator różnicowy symetryczny]
Dla ustalonego kroku $h>0$. Operatorem różnicowym symetrycznym nazywać będziemy 
$$
\overline{\delta_h} u(x) = \frac{u(x+h)-u(x-h)}{2h} 
$$
\end{definition}
\end{small}
\end{frame}
\begin{frame}
\begin{algorithm}[Schemat otwarty Eulera]\label{Euler_algoritm}
Następujące postępowanie służące do rozwiązywania zagadnienia Cauchy'ego nazywamy schematem otwartym Eulera:
\begin{enumerate}
\item Ustalamy $N$ ilość punktów w dziedzinie równania. 
\item Dla ustalonego $N$ wyznaczamy krok $h>0$ według wzoru $h=\frac{T_N - t_0}{N}$. 
\item Generujemy dyskretyzację dziedziny dla $ n \in \set{0,\cdots,N}  t_0 = t_0, t_1 = t_0 + h, \cdots, t_N = t_{0}+ Nh$. 
\item Ustalamy $x(t_0) = x_0$ zgodnie z warunkiem początkowym.
\item Dla kolejny $n \in \set{1, \ldots, N}$ stosujemy wzór
$$
x(t_{n}) = x(t_{n-1}) + h f(t_{n-1}, x(t_{n-1})).
$$
\end{enumerate}
\end{algorithm}
\end{frame}

\begin{frame} 
\includegraphics[scale=0.5]{licencjat-008}
\end{frame}
\begin{frame}
\begin{problem}[Zagadnienie brzegowe]
Zagadnieniem brzegowym liniowego problemu drugiego rzędu dla $ t \in (a,b) $ będziemy nazywać:
\begin{equation}
\left\{\begin{array}{ll}
\ddx [^2]{t} x(t) + c_1\ddx{t} x(t) + c_2x(t) = f(t), t \in (a,b), & \\
x(a) = \alpha, & \\
x(b) = \beta ,&
\end{array} \right.
\end{equation}
gdzie $\alpha$ i $\beta$ są ustalone. Rozwiązaniem tego zagadnienia nazwiemy funkcje $x$ klasy $C^2(a,b) \cap C([a,b])$ spełniającym powyższe warunki.
\end{problem}
\end{frame}
\begin{frame}
\begin{small}
\begin{theorem}[O istnieniu rozwiązania]
Jeśli funkcja $\frac{df}{du}(t,u)$ jest ciągła, nieujemna i ograniczona w obszarze określonym nierównościami $0\leq t \leq 1$, $-\infty < u < +\infty$ to problem brzegowy postaci:
\begin{equation}\label{zagad_brzeg}
\left\{\begin{array}{ll}
u''(t)=f(t,u), & t \in (0,1) \\
u(0)=0, & \\
u(1)=0,
\end{array}\right.
\end{equation}
posiada jednoznaczne rozwiązanie w przedziale $[0,1]$.
\end{theorem}
\begin{theorem}
Jeżeli $f(t,s)$ jest funkcją ciągłą, gdzie $t \in [0,1]$ i $s \in \setR$ spełniającą warunek taki, że
$$
|f(t,s_1) - f(t,s_2)| \leq k|s_1 - s_2|, \quad k<8,
$$
to zagadnienie brzegowe postaci \eqref{zagad_brzeg} posiada jednoznaczne rozwiązanie ciągłe w $[0,1]$. 
\end{theorem}
\end{small}
\end{frame}
\begin{frame}
\begin{theorem}
Rozważmy następujące dwa problemy brzegowe:
\begin{equation}\label{pierwszy_problem_brzegowy}
\left\{\begin{array}{ll}
u''(t)=f(t,u(t)), & t \in (a,b) \\
u(a)=\alpha, & \\
u(b)=\beta,
\end{array}\right.
\end{equation}
\begin{equation}\label{drugi_problem_brzegowy}
\left\{\begin{array}{ll}
y''(t)=g(t,y(t)), &  t \in (0,1)\\
y(0)= \alpha, & \\
y(1)= \beta,
\end{array}\right.
\end{equation}
gdzie 
$$
g(p,q) = (b-a)^2f(a+(b-a)p,q).
$$
Wtedy jeśli $y$ jest rozwiązaniem \eqref{drugi_problem_brzegowy}, wówczas funkcja $u: t \mapsto y\left(\frac{t-a}{b-a}\right)$ jest rozwiązaniem problemu \eqref{pierwszy_problem_brzegowy}. Ponadto, jeśli $u$ jest rozwiązaniem \eqref{pierwszy_problem_brzegowy}, wówczas $y: t \mapsto u(a+(b-a)t)$ jest rozwiązaniem problemu \eqref{drugi_problem_brzegowy}.
\end{theorem}
\end{frame}
\begin{frame}
\begin{theorem}
Rozważmy problemy brzegowe postaci:
\begin{equation}\label{trzeci_problem_brzegowy}
\left\{\begin{array}{ll}
y''(t)=g(t,y(t)), t \in(0,1)& \\
y(0)=\alpha, & \\
y(1)=\beta,
\end{array}\right.
\end{equation}
\begin{equation}\label{czwarty_problem_brzegowy}
\left\{\begin{array}{ll}
z''(t)=h(t,z(t)), & t \in (0,1)\\
z(0)= 0, & \\
z(1)= 0,
\end{array}\right.
\end{equation}
gdzie 
$$
h(p,q)= g(p,q+\alpha + (\beta - \alpha)p).
$$
Jeśli $z$ jest rozwiązaniem \eqref{czwarty_problem_brzegowy}, to funkcja $y: t \mapsto z(t) + \alpha + (\beta - \alpha)t$ jest rozwiązaniem \eqref{trzeci_problem_brzegowy}. Co więcej jeżeli $y$ jest rozwiązaniem \eqref{trzeci_problem_brzegowy}, to $z: t \mapsto y(t) - [\alpha + (\beta - \alpha)t]$ jest rozwiązaniem \eqref{czwarty_problem_brzegowy}.
\end{theorem}
\end{frame}
\begin{frame}
\begin{algorithm}[Metoda Strzału]
\begin{enumerate}
\item Rozważamy zagadnienie początkowe postaci
\begin{equation} \label{eq-shooting-auxiliary}
\left\{\begin{array}{ll}
u''(t)=h(t,u(t),u'(t)), & \\
u(a)= \alpha, & \\
u'(a)= z.
\end{array}\right.
\end{equation}
\item Oznaczmy przez $\Phi$ funkcję przypisującą dla wybranego $z \in \setR$ funkcję będącą rozwiązaniem \eqref{eq-shooting-auxiliary}.
\item Rozwiązujemy równanie postaci 
$$
\Phi(z) = \beta.
$$ 
\end{enumerate}
\end{algorithm}
\end{frame}
\begin{frame}
\begin{scriptsize}
\frametitle{Metoda różnic skończonych}
Sprowadźmy nasz problem do następującej postaci:
\begin{equation}\label{rownanie_brzegowe}
\left\{\begin{array}{ll}
u''(t)=f(t) + g(t) u(t) + m(t) u'(t), & t \in (a,b) \\
u(a)= \alpha, & \\
u(b)= \beta.
\end{array}\right.
\end{equation}
W przypadku tym układ równań do rozwiązania jest układem równań liniowych opisanych poniższymi zależnościami:
\begin{equation}\label{zagadnienie_liniowe}
\left\{\begin{array}{ll}
y_0 = \alpha, & \\
(1+ \frac{1}{2}h m(t_n))y_{n-1} - (2+ h^2 g(t_n))y_n + (1- \frac{1}{2}h m(t_n))y_{n+1} = h^2 f(t_n) ,& n \in \set{1,\cdots,N} \\
y_{N+1} = \beta,
\end{array}\right. 
\end{equation}
\end{scriptsize}
\end{frame}
\begin{frame}
\begin{small}
Wprowadźmy oznaczenia :
\begin{align*}
a_i:= 1 + \frac{1}{2}m(t_{i+1}),\\
d_i:= -(2+h^2 g(t_i)), \\
c_i:= 1 - \frac{1}{2}m(t_i), \\
b_i:= h^2 f(t_i).
\end{align*}
Wtedy powyższy układ równań możemy zapisać w postaci macierzowej:
\begin{equation}\label{macierz}
\left[ \begin{array}{ccccc}
d_1 & c_1 & 0 & 0 & 0 \\
a_1 & d_2 & c_2 & 0 & 0\\
\cdots & \cdots & \cdots &\cdots  &\cdots \\
0 & 0 & a_{N-2} & d_{N-1} & c_{N-1}\\
0 & 0 & 0 & a_{N-1} & d_N 
\end{array} \right] \cdot
\left[ \begin{array}{c}
y_1 \\
y_2 \\
\cdots \\
y_{N-1} \\
y_{N}  
\end{array} \right] =
\left[ \begin{array}{c}
b_1 - a_0\alpha\\
b_2 \\
\cdots \\
b_{n-1} \\
b_n -c_n\beta 
\end{array} \right] .
\end{equation}
\end{small}
\end{frame}
\begin{frame}
\begin{theorem}
Dla $h \to 0$ rozwiązania zadania dyskretnego są zbieżne do rozwiązania problemu brzegowego postaci \eqref{rownanie_brzegowe}.
\end{theorem}
\end{frame}
\begin{frame}
\begin{example}
Weźmy równanie:
$$
u''(t)= -u(t), \quad u(0)=3, \quad u(\frac{\pi}{2}) = 7,
$$
którego rozwiązaniem teoretycznym jest:
$$
u(t) = 7\sin(t) + 3\cos(t)
$$
\end{example}
\end{frame}
\begin{frame}[fragile]
\begin{small}
\begin{Schunk}
\begin{Sinput}
> schemat_brzegowy_pelny = function(f, g, m , t0 , tN, x0, xN , N)
+ {
+   h = (tN-t0)/N
+   t = seq(from=t0+h, to=t0+(N-1)*h,length.out = N-1)
+   A = diag(-2,nrow=N-1,ncol=N-1)
+   b = f(t) * h*h
+   b[1] = b[1] - (1+0.5*h* m(t0)) * x0
+   b[N-1] = b[N-1] - (1-0.5*h * m(tN)) * xN
+   for (i in (1:(N-1))){
+     if (i >1 )
+       A[i, i-1] = A[i, i-1] +1 + 0.5*h *m(t[i])
+     A[i,i] = A[i,i] - h^2 * g(t[i])
+     if (i < (N-1))
+       A[i,i+1] =  A[i, i+1] +1 - 0.5*h *m(t[i])
+   }
+   x = solve(A, b)
+   result = list(time=c(t0, t, tN), values = c(x0, x, xN))
+   return(result)
+ }
\end{Sinput}
\end{Schunk}
\end{small}
\end{frame}
\begin{frame}
\includegraphics[scale=0.5]{licencjat-018}
\end{frame}
\begin{frame}
\begin{problem}
Weźmy równanie różnicowe liniowe drugiego rzędu z warunkami brzegowymi postaci:
$$
\left\lbrace
\begin{array}{c}
-\Delta u(x,y) - \frac{\pi^2}{2}u(x,y) = f(x,y), \quad (x,y) \in \Omega, \\
u(x,y) = g(x,y), \quad (x,y) \in \delta \Omega.\\
\end{array}
\right.
$$
Dla funkcji $g$ oraz $f$ takich,że
$$
g(x,y) = \sin(\frac{\pi}{2}x) \cdot \sin(\frac{\pi}{2}y), \quad f(x,y)=0
$$
\end{problem}
\end{frame}
\begin{frame}
\includegraphics[scale=0.5]{licencjat-027}
\end{frame}
\end{document}