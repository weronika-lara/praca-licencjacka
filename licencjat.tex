\documentclass[12pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{polski}
\usepackage{ifthen}
\usepackage{url}
\usepackage{hyperref}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{natbib} %bibtex!!
\usepackage[polish]{dyschemist}

\author{Weronika Lara}
\title{Numeryczne rozwiązywanie równań różniczkowych drugiego rzędu z warunkami brzegowymi}
\begin{document}

\maketitle

\chapter{Wstęp}

Cytując \citep[Rozdział 3, sekcja 2]{palczewski2004rownania}

\chapter{Preliminaria}

\section{Oznaczenia w pracy}

W całości pracy stosowane są następujące oznaczenia dla powszechnie znanych pojęć.
\begin{itemize}
\item $\ddx{t} f(t)$ - oznaczać będzie pochodna funkcji $f$ po zmiennej $t$. W szczególności $\ddx[^n]{t^n}$ oznaczać będzie $n$-tą pochodną po tejże zmiennej.
\item $t, x, y, u$ - W przekroju pracy rozważane są równania zwyczajne oraz cząstkowe. W przypadku równań zwyczajnych najczęściej symbolem $t$ oznaczać będziemy zmienną, natomiast $x$ będzie używane do oznaczania poszukiwanej funkcji. W przypadku równań cząstkowych natomiast symbolami $t,x,y$ oznaczać będziemy zmienne (czasami również $x_1,\ldots,x_n$) natomiast $u$ oznaczać będzie naszą nieznaną i poszukiwaną funkcję.
\end{itemize}

\section{Elementy rachunku różniczkowego i całkowego}
\begin{definition}[Pochodna]
Niech $D \subset \setR^k , x^0 \in D , h \in \setR^k$. Jeżeli istnieje skończona granica
$$
\limit_{t \to 0}  \frac{f(x^0 + th) - f(x^0)}{t}
$$
to nazywamy ją pochodną funkcji $f$ w punkcie $x^0$ w kierunku wektora $h$ i oznaczamy ją $\ddx{x}f(x^0)$.  
\end{definition}

\begin{definition} [Pochodne cząstkowe]
Niech $D \subset \setR^k$ , $x^0 \in intD$ $ i \in {1,\cdots,k}$. Pochodną cząstkową funkcji $f$ w punkcie $x^0$ względem i-tej zmiennej (współrzędnej)  nazywamy pochodną kierunkową funkcji $f$ w punkcie $x^0$ w kierunku $e^i = (0, \cdots, 0, 1, 0, \cdots, 0) \in \setR^k$, o ile ona istnieje i oznaczamy $\ddx{x_i}f_{x_{i}}(x^0) $
\end{definition}

\begin{definition} [Gradient funkcji]
Jeżeli istnieją wszystkie pochodne cząstkowe funkcji $f$ w punkcie $x^0$, to wektor 
\begin{equation}
[\ddx{x_1}f_{x_{1}}(x_0), \cdots, \ddx{x_k}f_{x_{k}}(x_0)]
\end{equation}
 nazywamy gradientem funkcji $f$ w punkcie $x^0$ i oznaczamy $\bigtriangledown f(x^0)$ .
\end{definition}
\begin{definition}[klasa $C^{(k)}$]
Niech $U$ będzie otwartym podzbiorem $ \setR^n $, $ f: U \to \setR $. Mówimy, że funkcja $f$ jest klasy $C^{(k)}$ na $U$,  gdy w zbiorze $U$ istnieją wszystkie pochodne cząstkowe rzędu $k$ funkcji $f$ oraz są one funkcjami ciągłymi w zbiorze $U$. 
\end{definition}
\begin{theorem}[Wzór Taylora]
Dla funkcji $f: \setR \to \setR$ n-krotnie różniczkowalnej ($n \geq 1$) w punkcie $x_0 \in \setR $ istnieje
funkcja $ h_n: \setR \to \setR $, że 
\begin{equation}
f(x) = \sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!} (x-x_0){^k} + h_{n}(x)(x-x_0)^n 
\end{equation}
wielomian:
\begin{equation}
\sum_{k=0}^{n} \frac{f^{(k)}(x_0)}{k!} (x-x_0){^k}
\end{equation}
nazywamy wielomianem Taylora, funkcje $h_n$  dla $ n \to \infty$ spełniającą 
\begin{equation}
\lim_{x \to x_0} h_n = 0
\end{equation}
nazywamy resztą Peano .
\end{theorem}

\begin{definition}[Szereg Taylora]
Załóżmy, że funkcja $f$ ma pochodne wszystkich rzędów w pewnym otoczeniu $U$ punktu $x_0$. Szereg
\begin{equation}
\sum_{n=0}^{\infty} \frac{f^{(n)}(x_0)}{n!} (x-x_0)^n = f(x_0) + \frac{f^{(1)}(x_0)}{1!} (x-x_0) + \frac{f^{(2)}(x_0)}{2!} (x-x_0)^{2} + \cdots
\end{equation}
nazywamy szeregiem Taylora funkcji $f$ w otoczeniu punktu $x_0$. Wzór Taylora służy do przybliżania wartości funkcji dostatecznie dużo razy różniczkowalnych. W szczególności dla punktu $ x_0 = 0$ szereg Taylora przyjmuje postać 
\begin{equation}
\sum_{n=0}^{\infty} \frac{f^{(n)}(0)}{n!} x^n = f(0) + \frac{f^{(1)}(0)}{1!} x + \frac{f^{(2)}(0)}{2!}  x^{2} + \cdots
\end{equation}
i nazywa się w tym przypadku szeregiem Maclaurina. 

\end{definition}


\section{Elementy analizy funkcjonalne}

\begin{definition} [Punkt wewnętrzny zbioru]
Niech $A \subset \setR^k, x^0 \in \setR^k$ . Punkt $x^0$ nazywamy punktem wewnętrznym zbioru $A$ gdy:
$$
\exists  r>0 \quad   \ball{(r,x_0)} \subset A
$$
Wnętrzem zbioru $A$ nazywamy zbiór punktów wewnętrznych zbioru $A$ i oznaczamy go $IntA$.
\end{definition}

\begin{definition} [Zbiór otwarty] 
Zbiór $A$ nazywamy otwartym, gdy każdy punkt zbioru $A$ jest punktem wewnętrznym zbioru $A$. 
\end{definition}

\begin{definition} [Norma]
Niech $X$ będzie przestrzenią nad ciałem $K =\setR $ lub $ K = \setC $. Funkcję $\norm{\cdot}$ nazywamy normą na $X$ jeśli spełnione są następujące warunki 
\begin{enumerate}
\item Dla dowolnego $x\in X$
$$
 \norm{x} = 0 \implies x = \theta,
$$
\item Dla dowolnego $\alpha \in K$ oraz dowolnego $x \in X$ 
$$
\norm{\alpha x}  = \abs{\alpha}  \norm{x},
$$
\item Dla dowolnych $x,y\in X$
$$
 \norm{x+y} \leq \norm{x} + \norm{y}.
$$
\end{enumerate}

\end{definition}

\section{Równania różniczkowe zwyczajne}

\begin{definition} [Postać ogólna równania różniczkowego]
Niech $F \colon \setR \times \setR^{n+1} \to \setR$. Postacią ogólną równania różniczkowego zwyczajnego nazywamy równianie: 
\begin{equation*}
F(t, x(t), \ddx{t} x(t),..., \ddx[^k]{t^k} x(t) ) = 0,
\end{equation*}
gdzie $x \in \Ck{k}{(a,b); \setR^n}$ dla $F \colon D \to \setR^n$ i D zbioru otwartego w $\setR^{1+(k+1)n}$. 
Rzędem takiego równania nazywamy wtedy liczbę naturalną $k$. 
\end{definition}

Powyższa postać równania różniczkowego nie jest jednak najpowszechniej spotykaną. Powyższą postać możnaby utożsamiać z postacią uwikłaną funkcji. Częściej natomiast interesują nas równania różniczkowe zadane w postaci jawnej.

\begin{definition}[Postać jawna równania różniczkowego zwyczajnego]
Równaniem różniczkowym zwyczajnym w postaci jawnej nazwiemy równanie postaci
$$
\ddx[{^k x}]{t^k} = \function{f}{t,x,\ddx{t}x, \ldots, \ddx[{^{k-1}}]{t^{k-1}} x},
$$
którego rozwiązaniem jest funkcja $x \in \Ck{k}{(a,b), \setR^n}$.
\end{definition}

W dalszej części pracy zakładać będziemy, że nasze równania różniczkowe zawsze będą w postaci jawnej.


\subsection{Równanie różniczkowe zwyczajne pierwszego rzędu}

Skupmy na chwilę naszą uwagę jedynie na równaniu różniczkowym rzędu pierwszego. Wtedy równanie takie przyjmuje oczywiście postać 

$$
\ddx{t}x = f(t,x(t)), t \in (a,b) ,
$$ 

gdzie $(a,b) \subset \setR$ jest dowolnym nietrywialnym i ograniczonym przedziałem w $\setR$, oraz $ f \colon (a,b) \times G \subset \setR \times \setR^m \to \setR^m$ będące funkcją ciągłą. $G$ jest tu pewnym zbiorem otwartym w $\setR^m$. 

Interesować nas będzie następująca klasa problemów nazywana zagadnieniami początkowymi lub zagadnienia Cauchy'ego.

\begin{problem}[Zagadnienie Cauchy'ego] \label{prob-zagadnienie-cauchy}
Zagadnienie Cauchy'ego nazywamy równanie różniczkowe zwyczajne z warunkiem początkowym postaci:
\begin{align*}
\ddx{t} x &= f(t,x), \\
x(t_0) &= x_0,
\end{align*}
gdzie $t_0 \in (a,b)$, $x_0 \in G$ są ustalone z góry. 
\end{problem}

Pokażemy teraz przykład, który obrazuje zastosowanie równań różniczkowych zwyczajnych. 
\begin{example}[Model populacji gatunku ]
Najprostszy model populacji danego gatunku zwierząt:
\begin{align*}
\ddx{t}N = aN  t>t_0 \\
 N(t_0) = x_0 > 0
\end{align*}
gdzie $N(t)$ - stan populacji w momencie czasu $t$ i $a$ jest stałą większą od zera, szybkością namnażania się osobników, zależną od gatunku. Tu możemy podać rozwiązanie $N(t)=\exp(a(t-t_0))$.
\newline Ten model jest nierealistyczny, ponieważ populacja - nawet izolowana - nie może rosnąć do nieskończoności. 

\end{example}
\section{Równania różniczkowe cząstkowe}
Równania różniczkowe cząstkowe są to równania, których rozwiązaniami są funkcje wielu zmiennych oraz w których pojawiają się pochodne cząstkowe. W tej części wymienimy ich główne typy, którymi będziemy  posługiwali się  w dalszej części pracy. Wprowadźmy oznaczenie 
$$
\Delta = \sum_{k=1}^{n} \ddx[{^2 x}]{x^2}  
$$
dla $ x \in \Omega \subset \setR^{n} $ gdzie $\Omega$ jest obszarem. 
\subsection{Równania Eliptyczne}
Podstawowym przykładem zagadnienia eliptycznego jest równanie Laplace'a postaci 
$$
-\Delta u(x) = f(x). 
$$
Dokładając warunek brzegowy otrzymamy równanie zwane równaniem Poissona. Szukamy tutaj $u \in C^2(\Omega) \cap C(\Omega)$ takiego, że %tutaj Omega domknięta nie wiem jak zrobić omege z kreską nad sobą
\begin{align*}
-\Delta u(x) = f(x)  \\
u(s) = g(s) 
\end{align*}

dla $x \in \Omega$ i $s \in \eth \Omega$. 
Możemy również wyróżnić ogólniejszą definicję równania eliptycznego drugiego rzędu. Rozważmy równanie różniczkowe liniowe drugiego rzędu dla ogólnego operatora liniowego drugiego rzędu $L$ \label{line operator}, określonego dla $ u \in C^2(G)$ dla $G \subset \setR^{n}$ : %dopisac co to L
$$
Lu = -\sum_{k,l =1}^{n} a_kl(x) \ddx[u^2]{x^k} (x) + c(x)u(x) = f(x) 
$$
gdzie $ a_{kl}, b_{k}, c, f, $ są danymi funkcjami określonymi na $G \subset \setR^N$ .
\begin{definition}
Mówimy, że równanie  \ref{line operator} jest eliptyczne w punkcie $x$ gdy macierz $A(x) = (a_{kl}(x))_{kl=1,\cdots,n}$ jest dodatnio określona tzn dla dowolnego $ \xi \in \setR^{n}$ zachodzi :
$$
\xi^{t} A(x) \xi \geq 0
$$
Operator L jest eliptyczny w obszarze $\Omega$ jesli $L$ jest eliptyczny w każdym punkcie obszaru $\Omega$.
\end{definition}
\subsection{Równania hiperboliczne pierwszego rzędu}
Dla pewnego $ x \in \Omega \subset \setR^{N} $ równaniem różniczkowym hiperbolicznym pierwszego rzędu nazywamy równanie postaci:
$$
F(x,u,\ddx[{ u}]{u},...,\ddx[{u}]{u^N}) = 0
$$
gdzie $F : \Omega \times G \subset \Omega \times \setR \times \setR^{N} \to \setR$ i obszaru $\Omega \subset \setR^n $
\newline
W szczególności 
$$
F(x,u,\nabla u) = \vec{a(x)}^T \nabla u + b(x)
$$
dla danych funkcji $ a_k,b,c: \Omega \to \setR$. 
\subsection{Równania hiperboliczne drugiego rzędu} 
Dla dowolnego $t>0$ oraz $ x \in \Omega $ równaniem liniowym hiperbolicznym drugiego rzędu nazywamy równanie 
$$
\ddx[u^2]{t^2} - Lu = f
$$ 
dla operatora $L$ eliptycznego w $\Omega \subset \setR^N$, gdzie $ u_{tt} = \ddx[^2u]{t}$.  
\begin{example}[Równanie falowe]
Niech $x \in \Omega \subset \setR^N $ , dla $ N = 1,2,3$
$$
\ddx[^2u]{t^2} - \Delta u = f 
$$
\end{example}
\subsection{Równania paraboliczne}
Dla pewnego $t>0$, $x \in \Omega \subset \setR^N$ oraz operatora eliptycznego $L$ równanie
$$
\ddx[u]{t} -  Lu = f 
$$
nazywamy równaniem liniowym parabolicznym drugiego rzędu. 
\begin{example} [Równanie przewodnictwa cieplnego]
Niech $t>0$, $x \in \Omega \subset \setR^N $ dla $ N = 1,2,3 $
$$
\ddx[u]{t} - \Delta u = f
$$
\end{example}

\chapter{Numeryczne rozwiązywanie równań różniczkowych}

\section{Ogólna teoria numerycznego rozwiązywania równań różniczkowych}

Teoria równań różniczkowych dostarcza nam wielu narzędzi do rozwiązywania swoich równań. Nie pozwala jednak na rozwiązywanie znacznej ilości problemów napotykanych w zadaniach inżynierskich. Problemem są tutaj często skomplikowane postacie funkcji, ilość zmiennych definiowanych w problemie, czy też nieprzychylne obliczeniom wartości współczynników w równaniu. Spotyka się również sytuacje w których równania różniczkowe określają brak istnienia rozwiązania, tymczasem symulacje inżynierskie zdarzają się przeczyć temu faktowi. W takich sytuacjach cenione są metody przybliżonego rozwiązywania równań różniczkowych, obecnie głównie z wykorzystaniem komputerów. 

Aby umożliwić komputerowi rozwiazanie wybranego równania różniczkowego należy jednak pokanać kilka przeszkód. Zauważmy, że równania różniczkowe definiowane są niemal wyłącznie na ciągłych przedziałach dziedziny. Ponadto same przestrzenie naszych rozwiązań (przestrzenie funkcyjne) same posiadają nieskończenie, nieprzeliczalnie wiele, różnych funkcji. Stąd aby uzyskać przybliżone rozwiązanie wybranego równania różniczkowego, należy rozważyć podobny do niego model dyskretny - nazywany często jego dyskretyzacją. 

W teorii numerycznych równań różniczkowych spotyka sie dwa rodzaje dyskretyzacji.
\begin{itemize}
\item dyskretyzacja w dziedzinie,
\item dyskretyzacja w przestrzeni funkcyjnej.
\end{itemize}

W drugim rodzaju dysktretyzacji przestrzeń funkcji jest zastępowana skończoną liczbą kombinacji funkcji generujących. Funkcje generujące są wybierane na podstawie pewnych zestawów kryteriów. Jedną z najczęsciej spotykanych rodzajów funkcji generujących są tzw. elementy skończone. Tym rodzajem dyskretyzacji nie będziemy zajmować się wogóle w tej pracy.

Dyskretyzacja w dziedzinie oznacza zastąpienie ciągłego obszaru dziedziny za pomocą skończonej siatki punktów \footnote{nazywanej często 'grid'}. Funkcja będąca rozwiązaniem jest wtedy przybliżana za pomocą stablicowanej postaci, zaś na wykresie aproksymowana jest przez łamaną łączącą kolejne punkty wykresu. W tej pracy skupimy się wyłącznie na tym rodzaju dyskretyzacji. 

Dyskretyzacje w dziedzinie pozostawiają bogatą rodzinę modeli. Różnice pomiędzy tymi modelami najczęściej dotyczą sposobu aproksymowania operatora pochodnej, ewentualnie ilości składowych przy rozwijaniu wartości funkcji w szeregi potęgowe. 


\section{Numeryczne rozwiązywanie równań zwyczajnych}

W sekcji tej rozważamy zagadnienie Cauchy'ego (patrz problem \ref{prob-zagadnienie-cauchy}) pierwszego rzędu. 


\begin{theorem}[Peano]
Jeśli $f$ jest funkcją ciągłą na otoczeniu $(t_{0},x_{0})$, to istnieje rozwiązanie problemu \ref{prob-zagadnienie-cauchy} określone w pewnym otoczeniu $t_{0}$. 
\end{theorem}

\begin{theorem}[Picarda - Lindelfa]
Jeśli $f$ jest funkcją ciągłą na otoczeniu $(t_{0},x_{0})$ oraz $f$ jest funkcją lipschtizowską względem $x$ w pewnej kuli $\ball{(t_0,x_0)}{\delta}$. Tzn.
 istnieje taka $L\geq 0$, że dla każdych $((t,x),(t,y) \in \ball{(t_0,x_0)}{\delta} $ zachodzi
$$
  \norm{f(t,x) - f(t,y)} \leq L \norm{ x-y} 
$$
 to istnieje $ c> 0 $ i $x \in \Ck{1}{(t_0-c,t_0+c); \setR^{n} }  $ takie,że $x$ jest jednoznacznym rozwiązaniem (\ref{prob-zagadnienie-cauchy}).
\end{theorem}


Omówmy kilka najprostszych schematów przybliżonego rozwiązywania takich równań.

\subsection{Schemat otwarty Eulera}

\begin{definition}[Przybliżenie pochodnej dla schematu otwartego]
Przybliżeniem pochodnej w modelach dyskretyzacji opartych o schemat otwarty Eulera nazywamy przybliżenie pochodnej funkcji
$$
\ddx{t}x \approx \frac{x(t+h) - x(t)}{h},
$$
gdzie $h >0, h \in \setR $ jest ustalonym krokiem. 
\end{definition}

\begin{algorithm}[Schemat otwarty Eulera]
Następujące postępowanie służące do rozwiązywania zagadnienia \ref{prob-zagadnienie-cauchy} nazywamy schametam otwartym Eulera:
\begin{enumerate}
\item Ustalamy $N$ ilość punktów w dziedzinie równania. 
\item Ustalamy $h>0$ rozmiar kroku.
\item Generujemy dyskretyzację dziedziny $t_0 = t_0$, $t_1 = t_0 + h$, \ldots, $t_N = t_{N-1}+h$. 
\item Ustalamy $x(t_0) = x_0$ zgodnie z warunkiem początkowym.
\item Dla kolejny $n \in \set{0, \ldots, N-1}$ stosujemy wzór
$$
x(t_{n+1}) = x(t_n) + h f(t_n, x(t_n)).
$$
\end{enumerate}
\end{algorithm}

Wykorzystanie powyższego algorytmu zaprezentowaliśmy w przykładzie \ref{example-otwarty-euler}.

%TODO Teoria zbieżności schematów jednokrokowych.
\section{Teoria zbieżności schematów jednokrokowych}
Teoria zbieżnosci schematów jednokrokowych jest teorią odmienną od teorii dla schematów wielokrokowych liniowych. Należy więc wprowadzić parę istotnych pojęć przybliżających nam ten temat. 

\begin{definition} [Schemat k krokowy]
Schematem $k$ krokowym rozwiązania zagadnienia początkowego \ref{prob-zagadnienie-cauchy} ze stałym krokiem $h>0$ na odcinku $[t_0,T]$ nazywamy równanie
$$
x_n = \Phi (h,t_n,x_{n-k},\cdots,x_{n-1},x_n) \label{k-steps-scheme}
$$
dla $ n \geq k$ z warunkami startowymi $x_0,\cdots, x_{k-1}$ gdzie $t_n = t_0 + nh$.
\end{definition}

\begin{definition} [Błąd schematu jednokrokowego] 
Niech $ x \in C^{1}([t_0,T])$ dla zagadnienie początkowego \ref{prob-zagadnienie-cauchy} oraz $t=t_0 +nh \in [t_0,T]$.Bład schematu $k$ krokowego postaci \ref{k-steps-scheme} jest postaci 
$$
E_h(t) = |x^{h}_{n} - x(t)|
$$ 
natomiast błąd globalny 
$$
E_h = max_{n=0,\cdots,N} E_h(t^{h}_{n})
$$
\end{definition}
\begin{definition}[Zbieżność schematu]
Schemat jest zbieżny na $[t_0,T]$ jeśli 
$$
E_h \to 0  h \to 0
$$
a jest zbieżny z rzędem $p$ gdy dodatkowo dla pewnej stałej $C>0$ niezależnej od $h>0$ zachodzi 
$$
E_h \leq C h^p
$$
\end{definition}
\begin{definition}[Błąd lokalny]
Niech $x \in C^1([t_0,T]) $ będzie rozwiązaniem zagadnienia początkowego \ref{prob-zagadnienie-cauchy}. Dla $h>0$ i schematu $k$ krokowego postaci \ref{k-steps-scheme} błąd lokalny jest postaci
\begin{equation}
e_h = \max_{t \in [t_0,T-kh]} |x(t + kh) - \Phi (h,t,x(t),\cdots, x(t + kh))|
\end{equation}
\end{definition}
\begin{definition} [Rząd schematu]
Schemat \ref{k-steps-scheme} jest rzędu $p$ jeśli dla $x \in C^{p+1}([t_0,T])$ gdzie $x$ jest rozwiązaniem \ref{prob-zagadnienie-cauchy} zachodzi
$$
e_h \leq C h^{p+1}
$$
gdzie $C$ jest pewną stałą niezależną od $h$. 
\end{definition}
\begin{definition} [Schemat jednokrokowy] 
Schematem jednokrokowym dla problemu \ref{prob-zagadnienie-cauchy} dla stałego kroku $h = \frac{T-t_0}{N}$ nazywamy równanie różnicowe postaci:
$$
x_{n+1} = x_n + h \phi(h,t_{n},x_{n},x_{n+1}),  
$$
dla $n = 0,....,N$ oraz gdzie $t_{j} = t_{0} + jh$, a $\phi$ jest funkcją ciągłą określoną na $[0,H) \times [t_0,T) \times U_{x_0} \times U_{x_0} $ gdzie $ U_{x_0} $ jest otoczeniem $x_0$.   
\end{definition}
\begin{definition}[Schemat jednokrokowy otwarty]
Prz założeniach powyższej definicji, schematem jednokrokowym otwartym nazywamy 
$$
x_{n+1} = x_n + h \phi(h,t_{n},x_{n}),  
$$
\end{definition}
 
\begin{definition}[Zgodność schematu różnicowego]\label{definition-consistency}
Schemat jednokrokowy jest zgodny jeśli :
\begin{itemize}
\item $\phi$ jest ciągłą ze względu na wszystkie zmienne,
\item $\pi(0,t,x,x) = f(t,x)$ dla każdego $(t,x)$,
\item $\phi$ jest lipschtizowska ze względu na zmienne $x_n$ i $x_{n+1}$ tzn, istnieje stała $L>0$ taka, że dla wszystkich $x_1,x_2,y_1,y_2 \in U_{x_0}$ zachodzi
$$
\abs{\phi(h,t,x_1,x_2) - \phi(h,t,y_1,y_2)} \leq L  \sum_{k=1}^{2} \abs{x_k - y_k}
$$
\end{itemize}

\end{definition}

\begin{theorem}[O zbieżności schematu jednokrokowego] \label{theorem-convergence-one-step-schema} 
Jeśli rozwiązanie zagadnienia początkowego \ref{prob-zagadnienie-cauchy} $x \in C^{p+1}([t_0,T])$, schemat jednokrokowy jest zgodny i jest rzędu $p\geqslant1$, to ten schemat jest zbieżny z rzędem p. 

\end{theorem}
\begin{proof}[Dowód twierdzenia \ref{theorem-convergence-one-step-schema} dla schematów otwartych]

Niech $ x \in C^{p+1}([t_0,T]) $ będzie rozwiązaniem zagadnienia początkowego  \ref{prob-zagadnienie-cauchy}. Niech $ N \in \setN $ i $ h = \frac{T-t_0}{N} $. Niech $g$ będzie funkcją ze schematu jednokrokowego otwartego dla \ref{prob-zagadnienie-cauchy}. Załóżmy, że temat ten jest zgodny tzn. 
\begin{itemize}
\item $g$ jest ciągła ze względu na wszystkie zmienne 
\item $ g(0,t,x) = f(t,x)$ dla wszystkich $ (t,x) $
\item $ \exists_{L>0} $ takie, że dla wszystkich $x_1 , x_2 \in U_{x_{0}} $, $L$ niezależne od $h$ zachodzi
$$
\abs{\phi(h,t,x_1,) - \phi(h,t,x_2)} \leq L  \abs{x_1 - x_2} ,
$$
\end{itemize}
i jest rzędu $p$. 
Oznaczmy przez $ (x_n)_{n-0}^{N} $ ciąg wartości uzyskanych ze schematu jednokrokowego otwartego oraz $(t_n)_{n=0}^{N}$ ciąg czasów, opisanych formułą $ t_n = t_0 + nh $ , $ n \in \set{0, \cdots, N} $. Oznaczmy przez $E_n = x_n - x(t_n)$ błąd pomiędzy obliczonym schematem przybliżeniem rozwiązania dla czasu $t_n$, a dokładną wartością rozwiązania $x(t_n)$. Niech $\tau_n = x(t_{n+1}) - x(t_n) - h(g(h,t_n,x_n) $. Zauważmy, że 
$$
E_n = E_{n-1} + h(g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))) - \tau_{n-1} 
$$. 
Istotnie
\begin{equation}
\begin{array}{rl}
P &= E_{n-1} + h(g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))) - \tau_{n-1} \\
 &= x_{n-1} - x(t_{n-1} + h(g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))) - \tau_{n-1} \\
 &= x(t_{n}) - x(t_{n-1}) - h(g(h,t_{n-1},x_{n-1}) \\
 &= x_{n-1} + hg(h,t_{n-1},x(t_{n-1})) - x(t_n) \\
 &= x_n - x(t_n) = E_n 
\end{array}
\end{equation} 
Pokażemy, że zachodzi 
\begin{equation} \label{proof1}
\forall_{n \in \set{1,\cdots,N}} \quad  \abs{E_n} \leq (1 + h \cdot L) \abs{E_{n-1}} + \abs{\tau_{n-1}} .
\end{equation}
 
Niech $n \in \set{1,\cdots,N} $ 
\begin{equation}
\begin{array}{rl}
\abs{E_n} &= \abs{E_{n-1} + h(g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))) - \tau_{n-1}} \\
&\leq \abs{E_n-1} + h \abs{g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))} + \abs{ \tau_{n-1}}\\
&\leq \abs{E_n-1} + h \cdot L \abs{x_{n-1} - x(t_{n-1})} + \abs{ \tau_{n-1}}\\
&= \abs{E_n-1} + \abs{E_n-1} h \cdot L + \abs{ \tau_{n-1}}\\
&= \abs{E_n} \leq (1 + h \cdot L) \abs{E_{n-1}} + \abs{\tau_{n-1}} 
\end{array}
\end{equation}
Z dowolności $n \in \set{1, \cdots, N}$ mamy \ref{proof1}. 
Zauważmy, że 
$$
\forall_{n \in \set{1,\cdots,N}} \abs{E_n} \leq (1 + h \cdot L)^{n} \abs{E_0} + \sum_{k=0}^{n-1} (1+ h \cdot L)^{n-k-1} \abs{\tau_k} 
$$
Istotnie dla ustalonego $n$, stosując \ref{proof1} $n-1$ krotnie otrzymujemy powyższe. Korzystając z tego, że $|1+x|\leqslant e^{|x|}$ otrzymujemy
$$
\forall_{n \in \set{1,\cdots,N}}(1 + h \cdot L)^{n} \leq (1 + h \cdot L)^{N} \leq e^{N \cdot h \cdot L} \leq e^{L \cdot (T-t_0)} 
$$
dla $n$ takich, że $h\cdot n\leq  T - t_0 $ widzimy, że
$$
\abs{E_n} \leq e^{L \cdot (T-t_0)} \bracket{\abs{E_0} + \sum_{k=0}^{n-1}\abs{\tau_k}}
$$
Zauważmy, że $E_0 = 0$. Widzimy też, że 
$$
\abs{\tau_n} \leq e_h.
$$
Ponieważ schemat ma rząd $p$ to $\exists_C>0$ takie, że $e_h \leq Ch^{p+1} $ . Zatem
$$
\abs{E_N} \leq  e^{L \cdot (T-t_0)} \cdot N \cdot Ch^{p+1}
= e^{L \cdot (T-t_0)} \frac{T-t_0}{h} \cdot Ch^{p+1}
= e^{L \cdot (T-t_0)} (T-t_0) Ch^p
$$
Z dowolności $N$ mamy
$$
\forall_{N \in \setN} \abs{E_N} \leq e^{L \cdot (T-t_0)} (T-t_0) Ch^p
$$
gdy $ N \to \infty $ to $ h \to 0 $ oraz $ E_N \to 0$. Zatem schemat jest zbieżny z rzędem $p$.
\end{proof}






%\chapter{Schemat  Rungego-Kutty}
%Podstawową klasą schematów jednokrokowych są tzw. schematy Rungego-Kutty. 
%Załóżmy, że znamy $x_n$, i chcemy wyliczyć wartość $x_{n+1}$ ze wzoru uwzględniającego wartość
%pola wektorowego nie tylko w $x_n$, ale również w dodatkowym punkcie 
%$x^{\sim}$. Wtedy
%\begin{equation*}
%x_{n+1} = F(h,t_n,x_n,x^{\sim})
%\end{equation*}
%\newline
%Biorąc schemat otwarty Eulera z krokiem $h^{\sim}$ otrzymujemy punkt
%\begin{equation*}
%x^{\sim} = xn + h f^{\sim}(t,x(t))
%\end{equation*}
%\newline
%który, jak wiemy, przybliża $x(t+h^{\sim})$, ale niedokładnie. Możemy policzyć wartość pola wektorowego $f$ w tym punkcie i następnie, wykorzystując wartość $y_n = f(t_n, x_n)$ i $y^{\sim} = f(t_{n+h},x^{\sim})$, znaleźć lepsze przybliżenie $x(t_{n+1})$ - czyli np. za przybliżenie pola wektorowego wziąć ważoną średnią obu wartości $by_n+cy^{\sim}$ dla pewnych ustalonych wag $b$,$c$. Możliwości
%jest wiele. Pojawia się pytanie: jak oceniać różne konstrukcje $F$? Można tak dobierać $F$, aby rząd schematu był możliwie duży. 
%\newline
%Załóżmy, że $h^{\sim}=ah$. Wtedy szukamy schematu postaci:
%\begin{equation*}
%x_{n+1} = xn + bhf_n + chf(t_n + ah, x_n + ahf(t_n,x_n))
%\end{equation*}
%\newline
%tak, aby schemat miał maksymalny rząd.
%\newline
%Rozwijamy rozwiązanie $x$ w szereg Taylora:


\chapter{Cześć praktyczna}

\section{Schemat otwarty Eulera}


\begin{example}[Przykład] \label{example-otwarty-euler}
%TODO tutaj przykład porównujący schemat otwarty
\end{example}

\chapter{Podsumowanie}

\bibliographystyle{plain}
\bibliography{bibliografia}

\end{document}