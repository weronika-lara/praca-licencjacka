\documentclass[12pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{polski}
\usepackage{ifthen}
\usepackage{url}
\usepackage{hyperref}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{natbib} %bibtex!!
\usepackage[polish]{dyschemist}

\author{Weronika Lara}
\title{Numeryczne rozwiązywanie równań różniczkowych drugiego rzędu z warunkami brzegowymi}
\begin{document}

\maketitle

\chapter{Wstęp}

Cytując \citep[Rozdział 3, sekcja 2]{palczewski2004rownania}

\chapter{Preliminaria}

\section{Oznaczenia w pracy}

W całości pracy stosowane są następujące oznaczenia dla powszechnie znanych pojęć.
\begin{itemize}
\item $\ddx{t} f(t)$ - oznaczać będzie pochodna funkcji $f$ po zmiennej $t$. W szczególności $\ddx[^n]{t^n}$ oznaczać będzie $n$-tą pochodną po tejże zmiennej.
\item $t, x, y, u$ - W przekroju pracy rozważane są równania zwyczajne oraz cząstkowe. W przypadku równań zwyczajnych najczęściej symbolem $t$ oznaczać będziemy zmienną, natomiast $x$ będzie używane do oznaczania poszukiwanej funkcji. W przypadku równań cząstkowych natomiast symbolami $t,x,y$ oznaczać będziemy zmienne (czasami również $x_1,\ldots,x_n$) natomiast $u$ oznaczać będzie naszą nieznaną i poszukiwaną funkcję.
\end{itemize}

\section{Elementy rachunku różniczkowego i całkowego}

%TODO definicja przestrzeni C^k

\section{Elementy analizy funkcjonalne}

%TODO definicja zbioru otwartego


\begin{definition}
Niech $X$ będzie przestrzenią nad ciałem $K =\setR $ lub $ K = \setC $. Funkcję $\norm{\cdot}$ nazywamy normą na $X$ jeśli spełnione są następujące warunki 
\begin{enumerate}
\item Dla dowolnego $x\in X$
$$
 \norm{x} = 0 \implies x = \theta,
$$
\item Dla dowolnego $\alpha \in K$ oraz dowolnego $x \in X$ 
$$
\norm{\alpha x}  = \abs{\alpha}  \norm{x},
$$
\item Dla dowolnych $x,y\in X$
$$
 \norm{x+y} \leq \norm{x} + \norm{y}.
$$
\end{enumerate}

\end{definition}

\section{Równania różniczkowe zwyczajne}

\begin{definition}
Niech $F \colon \setR \times \setR^{n+1} \to \setR$. Postacią ogólną równania różniczkowego zwyczajnego nazywamy równianie: 
\begin{equation*}
F(t, x(t), \ddx{t} x(t),..., \ddx[^k]{t^k} x(t) ) = 0,
\end{equation*}
gdzie $x \in \Ck{k}{(a,b); \setR^n}$ dla $F \colon D \to \setR^n$ i D zbioru otwartego w $\setR^{1+(k+1)n}$. 
Rzędem takiego równania nazywamy wtedy liczbę naturalną $k$. 
\end{definition}

Powyższa postać równania różniczkowego nie jest jednak najpowszechniej spotykaną. Powyższą postać możnaby utożsamiać z postacią uwikłaną funkcji. Częściej natomiast interesują nas równania różniczkowe zadane w postaci jawnej.

\begin{definition}[Postać jawna równania różniczkowego zwyczajnego]
Równaniem różniczkowym zwyczajnym w postaci jawnej nazwiemy równanie postaci
$$
\ddx[{^k x}]{t^k} = \function{f}{t,x,\ddx{t}x, \ldots, \ddx[{^{k-1}}]{t^{k-1}} x},
$$
którego rozwiązaniem jest funkcja $x \in \Ck{k}{(a,b), \setR^n}$.
\end{definition}

W dalszej części pracy zakładać będziemy, że nasze równania różniczkowe zawsze będą w postaci jawnej.


\subsection{Równanie różniczkowe zwyczajne pierwszego rzędu}

Skupmy na chwilę naszą uwagę jedynie na równaniu różniczkowym rzędu pierwszego. Wtedy równanie takie przyjmuje oczywiście postać 

$$
\ddx{t}x = f(t,x(t)), t \in (a,b) ,
$$ 

gdzie $(a,b) \subset \setR$ jest dowolnym nietrywialnym i ograniczonym przedziałem w $\setR$, oraz $ f \colon (a,b) \times G \subset \setR \times \setR^m \to \setR^m$ będące funkcją ciągłą. $G$ jest tu pewnym zbiorem otwartym w $\setR^m$. 

Interesować nas będzie następująca klasa problemów nazywana zagadnieniami początkowymi lub zagadnienia Cauchy'ego.

\begin{problem}[Zagadnienie Cauchy'ego] \label{prob-zagadnienie-cauchy}
Zagadnienie Cauchy'ego nazywamy równanie różniczkowe zwyczajne z warunkiem początkowym postaci:
\begin{align*}
\ddx{t} x &= f(t,x), \\
x(t_0) &= x_0,
\end{align*}
gdzie $t_0 \in (a,b)$, $x_0 \in G$ są ustalone z góry. 
\end{problem}

%TODO przepisać przykład 2.1


\chapter{Numeryczne rozwiązywanie równań różniczkowych}

\section{Ogólna teoria numerycznego rozwiązywania równań różniczkowych}

Teoria równań różniczkowych dostarcza nam wielu narzędzi do rozwiązywania swoich równań. Nie pozwala jednak na rozwiązywanie znacznej ilości problemów napotykanych w zadaniach inżynierskich. Problemem są tutaj często skomplikowane postacie funkcji, ilość zmiennych definiowanych w problemie, czy też nieprzychylne obliczeniom wartości współczynników w równaniu. Spotyka się również sytuacje w których równania różniczkowe określają brak istnienia rozwiązania, tymczasem symulacje inżynierskie zdarzają się przeczyć temu faktowi. W takich sytuacjach cenione są metody przybliżonego rozwiązywania równań różniczkowych, obecnie głównie z wykorzystaniem komputerów. 

Aby umożliwić komputerowi rozwiazanie wybranego równania różniczkowego należy jednak pokanać kilka przeszkód. Zauważmy, że równania różniczkowe definiowane są niemal wyłącznie na ciągłych przedziałach dziedziny. Ponadto same przestrzenie naszych rozwiązań (przestrzenie funkcyjne) same posiadają nieskończenie, nieprzeliczalnie wiele, różnych funkcji. Stąd aby uzyskać przybliżone rozwiązanie wybranego równania różniczkowego, należy rozważyć podobny do niego model dyskretny - nazywany często jego dyskretyzacją. 

W teorii numerycznych równań różniczkowych spotyka sie dwa rodzaje dyskretyzacji.
\begin{itemize}
\item dyskretyzacja w dziedzinie,
\item dyskretyzacja w przestrzeni funkcyjnej.
\end{itemize}

W drugim rodzaju dysktretyzacji przestrzeń funkcji jest zastępowana skończoną liczbą kombinacji funkcji generujących. Funkcje generujące są wybierane na podstawie pewnych zestawów kryteriów. Jedną z najczęsciej spotykanych rodzajów funkcji generujących są tzw. elementy skończone. Tym rodzajem dyskretyzacji nie będziemy zajmować się wogóle w tej pracy.

Dyskretyzacja w dziedzinie oznacza zastąpienie ciągłego obszaru dziedziny za pomocą skończonej siatki punktów \footnote{nazywanej często 'grid'}. Funkcja będąca rozwiązaniem jest wtedy przybliżana za pomocą stablicowanej postaci, zaś na wykresie aproksymowana jest przez łamaną łączącą kolejne punkty wykresu. W tej pracy skupimy się wyłącznie na tym rodzaju dyskretyzacji. 

Dyskretyzacje w dziedzinie pozostawiają bogatą rodzinę modeli. Różnice pomiędzy tymi modelami najczęściej dotyczą sposobu aproksymowania operatora pochodnej, ewentualnie ilości składowych przy rozwijaniu wartości funkcji w szeregi potęgowe. 


\section{Numeryczne rozwiązywanie równań zwyczajnych}

W sekcji tej rozważamy zagadnienie Cauchy'ego (patrz problem \ref{prob-zagadnienie-cauchy}) pierwszego rzędu. 


\begin{theorem}[Peano]
Jeśli $f$ jest funkcją ciągłą na otoczeniu $(t_{0},x_{0})$, to istnieje rozwiązanie problemu \ref{prob-zagadnienie-cauchy} określone w pewnym otoczeniu $t_{0}$. 
\end{theorem}

\begin{theorem}[Picarda - Lindelfa]
Jeśli $f$ jest funkcją ciągłą na otoczeniu $(t_{0},x_{0})$ oraz $f$ jest funkcją lipschtizowską względem $x$ w pewnej kuli $\ball{(t_0,x_0)}{\delta}$. Tzn.
 istnieje taka $L\geq 0$, że dla każdych $((t,x),(t,y) \in \ball{(t_0,x_0)}{\delta} $ zachodzi
$$
  \norm{f(t,x) - f(t,y)} \leq L \norm{ x-y} 
$$
 to istnieje $ c> 0 $ i $x \in \Ck{1}{(t_0-c,t_0+c); \setR^{n} }  $ takie,że $x$ jest jednoznacznym rozwiązaniem (\ref{prob-zagadnienie-cauchy}).
\end{theorem}


Omówmy kilka najprostszych schematów przybliżonego rozwiązywania takich równań.

\subsection{Schemat otwarty Eulera}

\begin{definition}[Przybliżenie pochodnej dla schematu otwartego]
Przybliżeniem pochodnej w modelach dyskretyzacji opartych o schemat otwarty Eulera nazywamy przybliżenie pochodnej funkcji
$$
\ddx{t}x \approx \frac{x(t+h) - x(t)}{h},
$$
gdzie $h >0, h \in \setR $ jest ustalonym krokiem. 
\end{definition}

\begin{algorithm}[Schemat otwarty Eulera]
Następujące postępowanie służące do rozwiązywania zagadnienia \ref{prob-zagadnienie-cauchy} nazywamy schametam otwartym Eulera:
\begin{enumerate}
\item Ustalamy $N$ ilość punktów w dziedzinie równania. 
\item Ustalamy $h>0$ rozmiar kroku.
\item Generujemy dyskretyzację dziedziny $t_0 = t_0$, $t_1 = t_0 + h$, \ldots, $t_N = t_{N-1}+h$. 
\item Ustalamy $x(t_0) = x_0$ zgodnie z warunkiem początkowym.
\item Dla kolejny $n \in \set{0, \ldots, N-1}$ stosujemy wzór
$$
x(t_{n+1}) = x(t_n) + h f(t_n, x(t_n)).
$$
\end{enumerate}
\end{algorithm}

Wykorzystanie powyższego algorytmu zaprezentowaliśmy w przykładzie \ref{example-otwarty-euler}.

%TODO Teoria zbieżności schematów jednokrokowych.
\section{Teoria zbieżności schematów jednokrokowych}

\begin{definition}
Schematem jednokrokowym dla problemu \ref{prob-zagadnienie-cauchy} dla stałego kroku $h = \frac{T-t_0}{N}$ nazywamy równanie różnicowe postaci:
$$
x_{n+1} = x_n + h \phi(h,t_{n},x_{n},x_{n+1}),  
$$
dla $n = 0,....,N$ oraz gdzie $t_{j} = t_{0} + jh$, a $\phi$ jest funkcją ciągłą określoną na $[0,H) \times [t_0,T) \times U_{x_0} \times U_{x_0} $ gdzie $ U_{x_0} $ jest otoczeniem $x_0$.   
\end{definition}


Teoria zbieżnosci schematów jednokrokowych jest teorią odmienną od teorii dla schematów wielokrokowych liniowych. 

Istotnym pojęciem jest tu zgodność schematu jednokrokowego - inaczej konsystentność, którą definiujemy następująco: 

\begin{definition}[Zgodność schematu różnicowego]\label{definition-consistency}

Schemat jednokrokowy jest zgodny (konsystentny) jeśli :
\begin{itemize}
\item $\phi$ jest ciągłą ze względu na wszystkie zmienne,
\item $\pi(0,t,x,x) = f(t,x)$ dla każdego $(t,x)$,
\item $\phi$ jest lipschtizowska ze względu na zmienne $x_n$ i $x_{n+1}$ tzn, istnieje stała $L>0$ taka, że dla wszystkich $x_1,x_2,y_1,y_2 \in U_{x_0}$ zachodzi
$$
\abs{\phi(h,t,x_1,x_2) - \phi(h,t,y_1,y_2)} \leq L  \sum_{k=1}^{2} \abs{x_k - y_k}
$$
\end{itemize}

\end{definition}

\begin{theorem}[O zbieżności schematu różnicowego] \label{theorem-convergence-one-step-schema} 
Jeśli rozwiązanie zagadnienia początkowego \ref{prob-zagadnienie-cauchy} $x \in C^{p+1}([t_0,T])$, schemat jednokrokowy jest zgodny i jest rzędu $p\geqslant1$, to ten schemat jest zbieżny z rzędem p. 

\end{theorem}
\begin{proof}[Dowód twierdzenia \ref{theorem-convergence-one-step-schema} dla schematów otwartych]

Dowód zostanie przedstawiony tylko dla schematów otwartych rzędu $p$  tzn. $g(h,t,x,y) = g(h,t,x)$. 
Oznaczmy przez $E_n = x_n - x(t_n)$, czyli błąd pomiędzy obliczonym schematem przybliżeniem rozwiązania dla czasu $t_n$, a dokładną wartością rozwiązania $x(t_n)$. Niech $\tau_n = e_h(t_n) = x(t_{n+1}) - x(t_n) - h(g(h,t_n,x_n) $ czyli $\tau_n$ to lokalny błąd schematu dla czasu $t_n$. Wtedy otrzymujemy, że 
$E_n = E_{n-1} + h(g(h,t_{n-1},x_{n-1}) - g(h,t_{n-1},x(t_{n-1}))) - \tau_{n-1} $,
a stąd korzystając ze zgodności schematu, a dokładniej lipschtizowskości funkcji $g$, oraz definicji \ref{definition-consistency}, otrzymujemy
$$
\abs{E_n} \leq (1 + h \cdot L) \abs{E_{n-1}} + \abs{\tau_{n-1}} .
$$
Z indukcji matematycznej otrzymujemy:
$$
\abs{E_n} \leq (1 + h \cdot L)^{n} \abs{E_0} + \sum_{k=0}^{n-1} (1+ h \cdot L)^{n-k-1} \abs{\tau_k} 
$$
Korzystając z tego, że $|1+x|\leqslant e^{|x|}$ oraz 
$$
(1 + h \cdot L)^{n} \leq e^{n \cdot h \cdot L} \leq e^{L \cdot (T-t_0)} 
$$
dla $n$ takich, że $h\cdot n\leq  T - t_0 $ widzimy, że
$$
\abs{E_n} \leq e^{L \cdot (T-t_0)} \bracket{\abs{E_0} + \sum_{k=0}^{n-1}\abs{\tau_k}}
$$
Zauważmy, że $E_0 = 0$. Widzimy też, że 
$$
\abs{\tau_n} \leq e_h.
$$
Ponieważ schemat ma rząd $p$ i $x \in C^{p+1}$, to $ e_h = O(h^{p+1}) $ zatem 
$$ 
\abs{E_n} \leq e^{L\cdot(T-t_0)} n \cdot e_n \leq e^{L \cdot (T-t_0)} \frac{T-t_0}{h}O(h^{p+1}) = O(h^p).
$$ 

\end{proof}

\begin{remark*}
W szczególności zbieżność z rzędem $p$ oznacza dla ustalonego $t \in [t_0,T]$ i $n \cdot h = t$, że

$$
|x_n^{h} - x(t)| = O(h^{p}) \to 0  h = 0,
$$
gdy $n \to \infty$. 
\end{remark*}







% \section{Numeryczne rozwiązywanie równań hiperbolicznych}
% \section{Numeryczne rozwiązywanie równań eliptyczne}
% \section{Numeryczne rozwiązywanie równań parabolicznych}

%Najprostszą metodą numeryczną rozwiązywania równań różniczkowych jest metoda Eulera. Przybliżamy pochodną poprzez iloraz różnicowy dla pewnego
%parametru $h > 0$ 
%\begin{equation*}
%\frac{x(t+h) - x(t)}{h} \approx \frac{dx}{dt}
%\end{equation*}
%\newline
%i otrzymujemy otwarty schemat Eulera:
%\begin{equation*}
%\frac{x_h(t+h)-x_h(t)}{h} = f(t,x(t))
%\end{equation*}
%\newline 
%czy inaczej 
%\begin{equation*}
%x_h(t+h) = x_h(t) + hf(t,x(t))
%\end{equation*}
%\newline
%znając rozwiązanie w punkcie $t_0 x_h(t0) = x_0$ możemy wyznaczyć przybliżone rozwiązanie
%$xh$ w kolejnych punktach $t_n = t_0 + nh$ z powyższego wzoru. Ale można też przybliżyć
%pochodną biorąc parametr $-h$ w tył:
%\begin{equation*}
%\frac{x_h(t)-x_h(t-h)}{h} \approx \frac{dx}{dt}
%\end{equation*}
%\newline
%i wtedy zastępując pochodną przez taki iloraz otrzymujemy zamknięty schemat Eulera:
%\begin{equation*}
%\frac{x_h(t)-x_h(t-h)}{h} = f(t,x_h(t))
%\end{equation*}
%\newline
%czy inaczej 
%\begin{equation*}
%x_h(t+h) = x_h(t) + hf(t,x_h(t+h))
%\end{equation*}
%\newline
%Warto zauważyć, że jeśli znamy rozwiązanie w punkcie $t_0$, tzn.$ x_0$) = $x_0$, to aby wyznaczyć kolejne przybliżenia rozwiązania w punktach $t = t_n = t_0+nh$ należy rozwiązać równania postaci:
%\begin{equation*}
%g(y):= y -hf(t, y) - x_h(t) = 0
%\end{equation*}
%\newline
%względem $y$, co sprawia, że zamknięty schemat Eulera może wydać się mało praktyczny w porównaniu z otwartym schematem Eulera. Dla niektórych równań jest to pozorne. Zauważmy tylko, że im $h$ mniejsze, tym potencjalnie powyższe równanie jest łatwiejsze do rozwiązania. 
%\chapter{Schemat  Rungego-Kutty}
%Podstawową klasą schematów jednokrokowych są tzw. schematy Rungego-Kutty. 
%Załóżmy, że znamy $x_n$, i chcemy wyliczyć wartość $x_{n+1}$ ze wzoru uwzględniającego wartość
%pola wektorowego nie tylko w $x_n$, ale również w dodatkowym punkcie 
%$x^{\sim}$. Wtedy
%\begin{equation*}
%x_{n+1} = F(h,t_n,x_n,x^{\sim})
%\end{equation*}
%\newline
%Biorąc schemat otwarty Eulera z krokiem $h^{\sim}$ otrzymujemy punkt
%\begin{equation*}
%x^{\sim} = xn + h f^{\sim}(t,x(t))
%\end{equation*}
%\newline
%który, jak wiemy, przybliża $x(t+h^{\sim})$, ale niedokładnie. Możemy policzyć wartość pola wektorowego $f$ w tym punkcie i następnie, wykorzystując wartość $y_n = f(t_n, x_n)$ i $y^{\sim} = f(t_{n+h},x^{\sim})$, znaleźć lepsze przybliżenie $x(t_{n+1})$ - czyli np. za przybliżenie pola wektorowego wziąć ważoną średnią obu wartości $by_n+cy^{\sim}$ dla pewnych ustalonych wag $b$,$c$. Możliwości
%jest wiele. Pojawia się pytanie: jak oceniać różne konstrukcje $F$? Można tak dobierać $F$, aby rząd schematu był możliwie duży. 
%\newline
%Załóżmy, że $h^{\sim}=ah$. Wtedy szukamy schematu postaci:
%\begin{equation*}
%x_{n+1} = xn + bhf_n + chf(t_n + ah, x_n + ahf(t_n,x_n))
%\end{equation*}
%\newline
%tak, aby schemat miał maksymalny rząd.
%\newline
%Rozwijamy rozwiązanie $x$ w szereg Taylora:


\chapter{Cześć praktyczna}

\section{Schemat otwarty Eulera}


\begin{example}[Przykład] \label{example-otwarty-euler}
%TODO tutaj przykład porównujący schemat otwarty
\end{example}

\chapter{Podsumowanie}

\bibliographystyle{plain}
\bibliography{bibliografia}

\end{document}